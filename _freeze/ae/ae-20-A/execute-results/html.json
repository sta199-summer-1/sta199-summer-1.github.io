{
  "hash": "f146dc49ca9b1ab9a3ea1fe44ed1cfe9",
  "result": {
    "markdown": "---\ntitle: \"Hypothesis Testing\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n# Learning goals\n\nBy the end of today, you will...\n\n-   Use simulation-based methods to test a claim about a population parameter\n-   Use simulation-based methods to generate the null distribution\n-   Calculate and interpret the p-value\n-   Use the p-value to draw conclusions in the context of the data\n\nWe have data on the price per guest (ppg) for a random sample of 50 Airbnb listings in 2020 for Asheville, NC. We are going to use these data to investigate what we would of expected to pay for an Airbnb in in Asheville, NC in June 2020. Read in the data and answer the following questions. Today, we are going to investigate if the mean price of an Airbnb in Ashville, NC in June 2020 was larger than \\$60.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nabb <- read_csv(\"data/asheville.csv\")\n\nglimpse(abb)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 50\nColumns: 1\n$ ppg <dbl> 48.00000, 40.00000, 99.00000, 13.00000, 55.00000, 75.00000, 74.000…\n```\n:::\n:::\n\n\n## Setting up the hypotheses\n\nBased on the context of the problem, write out the correct null and alternative hypothesis. Do this in both words *and* in proper notation.\n\n$\\mu$ = The true / population mean price per guest for Airbnbs in in Asheville, NC in June 2020\n\n$H_o$: $\\mu$ = 60\n\n$H_a$: $\\mu$ \\> 60\n\n## Motivation\n\nWe want to know how unlikely it would be to observe our statistic under the assumption of the null hypothesis. Calculate and report the sample statistic below using proper notation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#insert-code-here\n\nabb |> \n  summarize(mean_ppg = mean(ppg)) #we use summarize when we want to calculate statistics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  mean_ppg\n     <dbl>\n1     76.6\n```\n:::\n\n```{.r .cell-code}\n                                  #we do this by first giving it the name of the new stat and then calculating the statistic after\n```\n:::\n\n\n$\\bar{x}$ = 76.6\n\n## Building a distribution\n\nLet's use simulation-based methods to conduct the hypothesis test specified above. We'll start by generating the null distribution.\n\n-   How do we generate the null distribution? Detail the steps below.\n\n*New idea: Shift! Shift each observation by the difference between our actual mean and our assumed population mean*\n\nNow, we resample with replacement 50 times, and take the mean of the new resampled data. \\<- Do this a bunch.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(101321)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist <- abb |>\n  specify(response = ppg) |>\n  hypothesize(null = \"point\", mu = 60) |>\n  generate(reps = 1000, type = \"bootstrap\") |>\n  calculate(stat = \"mean\") #this takes the name of the stat we are using. \n```\n:::\n\n\nTake a `glimpse` at null_dist. What does this represent?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(null_dist)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 2\n$ replicate <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…\n$ stat      <dbl> 54.94833, 60.20833, 48.79833, 55.28833, 64.59000, 42.30500, …\n```\n:::\n:::\n\n\n*These are a bunch of resampled means under the assumption that the true mean ppg is equal to 60.*\n\n## Visualize\n\nNow, create an appropriate visualization fo your null distribution. Where is this distribution centered? Why does this make sense?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist |> \n  ggplot(\n    aes(x = stat)\n  ) + \n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](ae-20-A_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n*The distribution is cenetered at the null value. This makes sense because we are resampling with replacement from data who's mean is the null value.*\n\nNow, add a vertical line on your null distribution that represents your sample statistic. Based on the position of this line, do you your sample mean is an unusual observation under the assumption of the null hypothesis?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist |> \n  ggplot(\n    aes(x = stat)\n  ) + \n  geom_histogram() + \n  geom_vline(xintercept = 76.6)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](ae-20-A_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n*I would say so. Our observation is out on the tail of our distribution.*\n\nLet's quantify your answer above....\n\n## p-value\n\nWhat is a p-value?\n\n*Probability*\n\nThe probability that we observe are sample statistic as extreme or more extreme given that the null hypothesis is true\n\nHow can we calculate it? Things to consider....\n\n*Add response*\n\nLet's put this in motion!\n\nWe are going to calculate the p-value in two different ways. The first one is \"by-hand\"\n\nLet's think about what's happening when we run `get_p_value`. Fill in the code below to calculate the p-value \"manually\" using some of the `dplyr` functions we've learned.\n\n-   Calculate your p-value\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist |>\n  filter(stat >= 76.6) |>\n  summarise(p_value = n() / nrow(null_dist))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.012\n```\n:::\n:::\n\n\n*0.012*\n\n-   Calculate your p-value below\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist |>\n  get_p_value(obs_stat = 76.6, direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.012\n```\n:::\n:::\n\n\nLet's visualize it!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvisualize(null_dist) +\n shade_p_value(obs_stat = 76.6, direction = \"greater\")\n```\n\n::: {.cell-output-display}\n![](ae-20-A_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n-   Interpret your p-value in the context of the problem\n\nThe probability that we observe are sample statistic as extreme or more extreme given that the null hypothesis is true\n\n*The probability that we observe a sample mean price of 76.6, or something greater, given that the true mean Airbnb price is equal to 60, is 0.012*\n\n## Conclusion\n\nUse the p-value to make your conclusion using a significance level of 0.05. Remember, the conclusion has 3 components\n\n-   How the p-value compares to the significance level\n-   The decision you make with respect to the hypotheses (reject $H_0$ /fail to reject $H_0$)\n-   The conclusion in the context of the **alternative hypothesis**\n\n## Significance level\n\nWhat is it?\n\n$\\alpha$ = a measure of the strength of the evidence that must be present in your sample before rejecting the null and concluding your alternative hypothesis\n\n$\\alpha$ = 0.05 \\> p-value 0.012 Reject the null hypothesis Strong evidence to conclude the alternative hypothesis\n\n*So, because our p-value is less than our significance level, we have strong evidence to reject the null hypothesis, and conclude that the true mean price per guess for airbnbs in Ashville, NC in June 2020 is larger than 60\\$.*\n\nExample:\n\n$\\alpha$ = 0.05 \\< p-value 0.120 Failing to reject our null hypothesis Weak evidence to conclude the alternative hypothesis\n\n## Two-sided\n\nSuppose instead you wanted to test the claim that the mean price of an Airbnb is not equal to \\$60. Which of the following would change? *Select all that apply.*\n\na.  Null hypothesis\nb.  *Alternative hypothesis*\nc.  Null distribution\nd.  *p-value*\n\n## Conclusion\n\nLet's test the claim in last exercise. Conduct the hypothesis test, then state your conclusion in the context of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist |>\n  get_p_value(obs_stat = 76.6, direction = \"two sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.024\n```\n:::\n:::\n\n\n## Optional\n\nWe can never conclude the null hypothesis.... but why?\n\nLet's assume your null hypothesis for the Airbnb question is: $\\mu$ = 70, and you are interested in $\\mu$ \\> 70\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist2 <- abb |>\n  specify(response = ppg) |>\n  hypothesize(null = \"point\", mu = 70) |>\n  generate(reps = 1000, type = \"bootstrap\") |>\n  calculate(stat = \"mean\")\n\nvisualize(null_dist2) +\n shade_p_value(obs_stat = 76.6, direction = \"greater\")\n```\n\n::: {.cell-output-display}\n![](ae-20-A_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nnull_dist2 |>\n  get_p_value(obs_stat = 76.6, direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.176\n```\n:::\n:::\n\n\nSo now.... I **incorrectly** conclude that $\\mu$ = 70.\n\nAnother research assumes that $\\mu$ = 72....\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist3 <- abb |>\n  specify(response = ppg) |>\n  hypothesize(null = \"point\", mu = 72) |>\n  generate(reps = 1000, type = \"bootstrap\") |>\n  calculate(stat = \"mean\")\n\nvisualize(null_dist3) +\n shade_p_value(obs_stat = 76.6, direction = \"greater\")\n```\n\n::: {.cell-output-display}\n![](ae-20-A_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nnull_dist3 |>\n  get_p_value(obs_stat = 76.6, direction = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  p_value\n    <dbl>\n1   0.266\n```\n:::\n:::\n\n\nSo now.... I **incorrectly** conclude that $\\mu$ = 72....??????\n\n![](images/null-hypothesis-meme.jpg)\n\n## Extra Practice\n\nCreate a new variable `over50` that indicates whether or not an Airbnb price is greater than \\$50.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code\n```\n:::\n\n\nSuppose you are interested in testing whether a majority of Airbnbs in Ashville, NC in June 2020 have a price lower than \\$50.\n\n-   State the null and alternative hypotheses.\n\n-   Fill in the code to generate the null distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist <- ____ |>\n  specify(response = ____, success = \"_____\") |>\n  hypothesize(null = \"point\", p = ____) |>\n  generate(reps = 1000, type = \"draw\") |>\n  calculate(stat = \"prop\")\n```\n:::\n\n\n-   Visualize the null distribution and shade in the area used to calculate the p-value.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code \n```\n:::\n\n\n-   Calculate p-value. Then use the p-value to make your conclusion using a significance level of 0.05.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add code\n```\n:::\n",
    "supporting": [
      "ae-20-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}