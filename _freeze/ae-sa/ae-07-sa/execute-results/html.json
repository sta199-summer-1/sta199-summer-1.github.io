{
  "hash": "1889e5ca1c2ca589615feaa4f1648cd0",
  "result": {
    "markdown": "---\ntitle: \"AE 07: Finishing Pivoting StatSci Majors\"\ncategories: \n  - Application exercise\neditor: visual\n---\n\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Goal\n\nOur ultimate goal in this application exercise is to make the following data visualization.\n\n![](images/statsci-plot.png){fig-alt=\"Line plot of numbers of Statistical Science majors over the years (2011 - 2021). Degree types represented are BS, BS2, AB, AB2. There is an increasing trend in BS degrees and somewhat steady trend in AB degrees.\" fig-align=\"center\"}\n\n## Data\n\nThe data come from the [Office of the University Registrar](https://registrar.duke.edu/registration/enrollment-statistics). They make the data available as a table that you can download as a PDF, but I've put the data exported in a CSV file for you. Let's load that in.\n\nThe first column (variable) is the `degree`, and there are 4 possible degrees: BS (Bachelor of Science), BS2 (Bachelor of Science, 2nd major), AB (Bachelor of Arts), AB2 (Bachelor of Arts, 2nd major). The remaining columns show the number of students graduating with that major in a given academic year from 2011 to 2021.\n\nTake a look at the origional data set.... \n\n## Data In\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatsci <- read_csv(\"data/statsci.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 4 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (1): degree\ndbl (12): id, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nslice(statsci)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 13\n     id degree    `2011` `2012` `2013` `2014` `2015` `2016` `2017` `2018` `2019`\n  <dbl> <chr>      <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1     1 Statisti…     NA      1     NA     NA      4      4      1     NA     NA\n2     2 Statisti…      2      2      4      1      3      6      3      4      4\n3     3 Statisti…      2      6      1     NA      5      6      6      8      8\n4     4 Statisti…      5      9      4     13     10     17     24     21     26\n# … with 2 more variables: `2020` <dbl>, `2021` <dbl>\n```\n:::\n:::\n\n\nLast class, we got this point where we making the following draft plot. Below, please talk through the code as a sentence to situate ourselves \n\n![](images/statsci-plot-draft.png){fig-alt=\"Line plot of numbers of Statistical Science majors over the years (2011 - 2021). Degree types represented are BS, BS2, AB, AB2. There is an increasing trend in BS degrees and somewhat steady trend in AB degrees.\" fig-align=\"center\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatsci |>\n  pivot_longer(\n    cols = !c(id,degree),\n    names_to = \"year\",\n    names_transform = as.numeric,\n    values_to = \"n\"\n  ) |>\n  mutate(n = if_else(is.na(n), 0, n)) |>\n  separate(degree, sep = \" \\\\(\", into = c(\"major\", \"degree_type\")) |>\n  mutate(\n    degree_type = str_remove(degree_type, \"\\\\)\"),\n    degree_type = fct_relevel(degree_type, \"BS\", \"BS2\", \"AB\", \"AB2\")\n    ) |> \n  ggplot(\n    aes(x = year, y = n, color = degree_type)\n  ) + \n  geom_point() + \n  geom_line()\n```\n\n::: {.cell-output-display}\n![](ae-07-sa_files/figure-html/initial-plot-1.png){width=672}\n:::\n:::\n\n\n-   **Your turn (4 minutes):** What aspects of the plot need to be updated to go from the draft you created above to the [Goal] plot at the beginning of this application exercise.\n\n**Axis, legend, color, labels**\n\n-   Demo: Update x-axis scale such that the years displayed go from 2011 to 2021 in increments of 2 years. Do this by adding on to your pipeline from earlier.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatsci |>\n  pivot_longer(\n    cols = !c(id,degree),\n    names_to = \"year\",\n    names_transform = as.numeric,\n    values_to = \"n\"\n  ) |>\n  mutate(n = if_else(is.na(n), 0, n)) |>\n  separate(degree, sep = \" \\\\(\", into = c(\"major\", \"degree_type\")) |>\n  mutate(\n    degree_type = str_remove(degree_type, \"\\\\)\"),\n    degree_type = fct_relevel(degree_type, \"BS\", \"BS2\", \"AB\", \"AB2\")\n    ) |>\n  ggplot(aes(x = year, y = n, color = degree_type)) +\n  geom_point() +\n  geom_line() +\n  scale_x_continuous(breaks = seq(2011,2021,2))\n```\n:::\n\n\n-   **Demo:** Update line colors using the following level / color assignments. Once again, do this by adding on to your pipeline from earlier. Hint: we can use `scale_color_manual` when we want to manually set colors!\n\n    -   \"BS\" = \"cadetblue4\"\n\n    -   \"BS2\" = \"cadetblue3\"\n\n    -   \"AB\" = \"lightgoldenrod4\"\n\n    -   \"AB2\" = \"lightgoldenrod3\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatsci |>\n  pivot_longer(\n    cols = !c(id,degree),\n    names_to = \"year\",\n    names_transform = as.numeric,\n    values_to = \"n\"\n  ) |>\n  mutate(n = if_else(is.na(n), 0, n)) |>\n  separate(degree, sep = \" \\\\(\", into = c(\"major\", \"degree_type\")) |>\n  mutate(\n    degree_type = str_remove(degree_type, \"\\\\)\"),\n    degree_type = fct_relevel(degree_type, \"BS\", \"BS2\", \"AB\", \"AB2\")\n    ) |>\n  ggplot(aes(x = year, y = n, color = degree_type)) +\n  geom_point() +\n  geom_line() +\n  scale_x_continuous(breaks = seq(2011, 2021, 2)) +\n  scale_color_manual(values = c(\"BS\" = \"cadetblue4\", \"BS2\" = \"cadetblue3\", \"AB\" = \"lightgoldenrod4\", \"AB2\" = \"lightgoldenrod3\"))\n```\n:::\n\n\nNow, let's fix the labels and add `theme_minimal` to the plot!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatsci |>\n  pivot_longer(\n    cols = !c(id,degree),\n    names_to = \"year\",\n    names_transform = as.numeric,\n    values_to = \"n\"\n  ) |>\n  mutate(n = if_else(is.na(n), 0, n)) |>\n  separate(degree, sep = \" \\\\(\", into = c(\"major\", \"degree_type\")) |>\n  mutate(\n    degree_type = str_remove(degree_type, \"\\\\)\"),\n    degree_type = fct_relevel(degree_type, \"BS\", \"BS2\", \"AB\", \"AB2\")\n    ) |>\n  ggplot(aes(x = year, y = n, color = degree_type)) +\n  geom_point() +\n  geom_line() +\n  scale_x_continuous(breaks = seq(2011, 2021, 2)) +\n  scale_color_manual(\n    values = c(\"BS\" = \"cadetblue4\",\n               \"BS2\" = \"cadetblue3\",\n               \"AB\" = \"lightgoldenrod4\",\n               \"AB2\" = \"lightgoldenrod3\")) +\n  labs(x = \"Graduation year\", \n       y = \"Number of majors graduating\",\n       color = \"Degree type\", \n       title = \"Statistical Science majors over the years\",\n       subtitle = \"Academic year 2011-2021\",\n       caption = \"Source: Office of the University\") +\n  theme_minimal()\n```\n:::\n\n\n-   **Demo:** Finally, adding to your pipeline you've developed so far, move the legend into the plot, make its background white, and its border gray. Set `fig-width: 7` and `fig-height: 5` for your plot in the chunk options. The code below does this for you. Practice reading the code as a sentence below.\n\nHint: What function have we used to work with legends?\n\n**theme!**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstatsci |>\n  pivot_longer(\n    cols = !c(id,degree),\n    names_to = \"year\",\n    names_transform = as.numeric,\n    values_to = \"n\"\n  ) |>\n  mutate(n = if_else(is.na(n), 0, n)) |>\n  separate(degree, sep = \" \\\\(\", into = c(\"major\", \"degree_type\")) |>\n  mutate(\n    degree_type = str_remove(degree_type, \"\\\\)\"),\n    degree_type = fct_relevel(degree_type, \"BS\", \"BS2\", \"AB\", \"AB2\")\n    ) |>\n  ggplot(aes(x = year, y = n, color = degree_type)) +\n  geom_point() +\n  geom_line() +\n  scale_x_continuous(breaks = seq(2011, 2021, 2)) +\n  scale_color_manual(\n    values = c(\"BS\" = \"cadetblue4\",\n               \"BS2\" = \"cadetblue3\",\n               \"AB\" = \"lightgoldenrod4\",\n               \"AB2\" = \"lightgoldenrod3\")) +\n  labs(\n    x = \"Graduation year\",\n    y = \"Number of majors graduating\",\n    color = \"Degree type\",\n    title = \"Statistical Science majors over the years\",\n    subtitle = \"Academic years 2011 - 2021\",\n    caption = \"Source: Office of the University Registrar\\nhttps://registrar.duke.edu/registration/enrollment-statistics\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = c(0.2,0.8),\n    legend.background = element_rect(\n      fill = \"white\" , color = \"gray\"\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](ae-07-sa_files/figure-html/final-plot-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ae-07-sa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}