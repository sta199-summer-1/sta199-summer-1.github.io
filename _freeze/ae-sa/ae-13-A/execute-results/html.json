{
  "hash": "d6e27c248b1e523e62c4db05fc1f728e",
  "result": {
    "markdown": "---\ntitle: \"Suggested Answers: More Models\"\nformat: html\neditor: visual\n---\n\n\n## Packages\n\nNote - if you don't have the plotly or widgetframe package, you can install these before running `library` by writing the following code in the console:\n\ninstall.packages(\"plotly\") install.packages(\"widgetframe\")\n\nThese packages are not necessary to finish the AE.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(palmerpenguins)\nlibrary(plotly)\nlibrary(widgetframe)\n```\n:::\n\n\n## Interaciton Model\n\n-- Fit the interaction model that models body mass by island and flipper length. Display the summary output.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nint_model <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ flipper_length_mm * island, data = penguins)\n```\n:::\n\n\n-- Below, write out the estimate regression equation below.\n\n$\\widehat{body\\_mass\\_g} = -5464 + 48.5*flipper + 3551*Dream + 3218*Torgersen - 19.4*flipper*Dream - 17.4*flipper*Torgersen$\n\n{1 if Dream; 0 else} {1 if Torgersen; 0 else}\n\n-- Now, write out the estimated regression equation for each island. Show how the slopes by island.\n\nBiscoe: $\\widehat{body\\_mass} = -5464 + 48.5*flipper}$\n\nDream: $\\widehat{body\\_mass} = (-5464 + 3551) + (48.5 - 19.7)*flipper$\n\nTorgersen: $\\widehat{body\\_mass} = (-5464 + 3218) + (48.5 - 17.4)*flipper$\n\nNow, name your interaction model `int_model` and remove the tidy() from the pipeline. Use this named model to make this prediction below.\n\n-- Predict the body mass of a penguin with a flipper length of 200 on the Dream island\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(int_model, data.frame(flipper_length_mm = 200, island = \"Dream\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  .pred\n  <dbl>\n1 3915.\n```\n:::\n:::\n\n\nHow does the picture change if our two explanatory variables are quantitative?\n\nIn this example, let's explore body mass, and it's relationship to bill length and flipper length.\n\n-- Brainstorm, how could we visualize this?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquanplot <- plot_ly(penguins, \n                    x = ~ flipper_length_mm, y = ~ body_mass_g, z = ~bill_length_mm,\n                    marker = list(size = 3, color = \"lightgray\" , alpha = 0.5, \n                                  line = list(color = \"gray\" , width = 2))) |>\n                      add_markers() |>\n                      plotly::layout(scene = list(\n                        xaxis = list(title = \"Flipper (mm)\"),\n                        yaxis = list(title = \"Bill (mm)\"), \n                        zaxis = list(title = \"Body Mass (g)\")\n                      )) |>\n                    config(displayModeBar = FALSE)\n                  frameWidget(quanplot)\n```\n:::\n\n\n-- Now, fit the additive model between flipper length, bill length, and body mass below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_model <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ flipper_length_mm + bill_length_mm, data = penguins) \n```\n:::\n\n\n-- Interpret bill length in the context of the problem.\n\n\"Holding all other variables constant\" \"Estimate a mean change in Y\" \"For a one unit increase in X.....\"\n\nHolding flipper length constant, for a one mm increase in bill length, we estimate a mean change in body mass of 6.05 grams.\n\n-- Finally, fit the interaction model between flipper length, bill length, and body mass.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nint_model2 <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ flipper_length_mm * bill_length_mm, data = penguins) \n```\n:::\n\n\nbody mass's relationship with flipper length depends on the penguins bill length\n\n-- Lastly, calculate the R-squared (coefficient of determination) for each model fit today. Interpret the largest R-squared value in the context of the problem.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(int_model)$r.squared #let's interpret this one\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7857486\n```\n:::\n\n```{.r .cell-code}\nglance(add_model)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7599577\n```\n:::\n\n```{.r .cell-code}\nglance(int_model2)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7694049\n```\n:::\n:::\n\n\nOur interaction model with flipper length and island explains roughly 79% of the variation in body mass.\n\nWhat really is R-squared? (See slides)\n\n## Model Selection\n\nHow can we choose between the models that we fit? Which one is the best?\n\nAdjusted r-squared and AIC are two common methods (see ae-14)\n\n## Extra Practice (Changing the default intercept term)\n\nWhen we modeled body mass by island when learning SLR. The default was to have the Biscoe island as the baseline (intercept) term. What if we want to change that?\n\nThere are many ways to do this. Using `mutate` and `factor`, change the intercept term to be the Dream island. Note how the estimates change in the model as a result.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ island *flipper_length_mm, data = penguins) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  term                              estimate std.error statistic  p.value\n  <chr>                                <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                        -5464.     431.      -12.7  2.51e-30\n2 islandDream                         3551.     969.        3.66 2.89e- 4\n3 islandTorgersen                     3218.    1680.        1.92 5.62e- 2\n4 flipper_length_mm                     48.5      2.05     23.7  1.66e-73\n5 islandDream:flipper_length_mm        -19.4      4.94     -3.93 1.03e- 4\n6 islandTorgersen:flipper_length_mm    -17.4      8.73     -1.99 4.69e- 2\n```\n:::\n\n```{.r .cell-code}\npenguins <- penguins |>\n  mutate(island = factor(island, levels = c(\"Dream\" , \"Biscoe\", \"Torgersen\")))\n\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ island * flipper_length_mm, data = penguins) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  term                              estimate std.error statistic  p.value\n  <chr>                                <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)                       -1913.      868.      -2.20  2.82e- 2\n2 islandBiscoe                      -3551.      969.      -3.66  2.89e- 4\n3 islandTorgersen                    -333.     1841.      -0.181 8.57e- 1\n4 flipper_length_mm                    29.1       4.49     6.49  3.12e-10\n5 islandBiscoe:flipper_length_mm       19.4       4.94     3.93  1.03e- 4\n6 islandTorgersen:flipper_length_mm     1.99      9.60     0.208 8.36e- 1\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}