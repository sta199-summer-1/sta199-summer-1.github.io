{
  "hash": "700b2fe2c0dc6f1e9128042120d401f4",
  "result": {
    "markdown": "---\ntitle: \"Regression with a Single Predictor\"\nsubtitle: \"Suggested Answers\"\ncategories: \n  - Application exercise\neditor: visual\n---\n\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(palmerpenguins)\n```\n:::\n\n\nToday, we will revisit the penguins data set. If needed, please re-familiarize yourself by reading the following context and taking a `glimpse` at the data set before we get started.\n\nThis data set comprising various measurements of three different penguin species, namely Adelie, Gentoo, and Chinstrap. The rigorous study was conducted in the islands of the Palmer Archipelago, Antarctica. These data were collected from 2007 to 2009 by Dr. Kristen Gorman with the Palmer Station Long Term Ecological Research Program, part of the US Long Term Ecological Research Network. The data set is called `penguins`.\n\n-   Take a glimpse of the data set below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 344\nColumns: 8\n$ species           <fct> Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…\n$ island            <fct> Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…\n$ bill_length_mm    <dbl> 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …\n$ bill_depth_mm     <dbl> 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …\n$ flipper_length_mm <int> 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…\n$ body_mass_g       <int> 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …\n$ sex               <fct> male, female, female, NA, female, male, female, male…\n$ year              <int> 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…\n```\n:::\n:::\n\n\nWe are going to investigate the relationship between a penguin's flipper length and their body mass. Specifically, we are interested in the effect flipper length has on the body mass of penguins.\n\n-   Based on our research question, which variable is the response variable?\n\n**body mass in the response; flipper length is the explanatory**\n\n-   Now, visualize the relationship between the two variables. Include the \"line of best fit\" in your plot. Recall from a a previous lab, we can fit this line using `geom_smooth`. If we want to fit a straight line, use the argument `method = \"lm\"`. Turn the standard error bars off using `se=F` argument.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  ggplot(\n    aes(x = flipper_length_mm, y = body_mass_g)\n  ) + \n  geom_point() + \n  geom_smooth(method = \"lm\" , se = F)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](ae-08-sa_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThis line **estimates** the relationship between our two variables. Below, we will practice writing out population and estimated models.\n\n## Model these Data\n\n-   Write the population model below that explains the relationship between body mass and flipper length.\n\nHint: You can type equations within dollar signs. LaTeX equations are authored using standard Pandoc markdown syntax (the editor will automatically recognize the syntax and treat the equation as math in the code chunks). It will appear as rendered math in your document.\n\nUseful tips:\n\n\";\" is a space in Pandoc markdown\n\nMore tips below:\n\n$x^2 \\; superscript$\n\n$x_2 \\; subscript$\n\n$\\hat{x}\\; adds\\; hat\\; to\\; x$\n\n$\\beta \\; this\\; is\\; beta$\n\n$\\epsilon\\; this\\; is\\; epsilon$\n\nExample:\n\n$\\hat{x^n} + \\beta^n = z_n + \\epsilon_i$\n\n$body-mass_i = \\beta_o + \\beta_1*flipper-length_i +\\epsilon_i$\n\n-   Now, fit the linear regression model and display the results. Write the estimated model output below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ flipper_length_mm, data = penguins) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 5\n  term              estimate std.error statistic   p.value\n  <chr>                <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)        -5781.     306.       -18.9 5.59e- 55\n2 flipper_length_mm     49.7      1.52      32.7 4.37e-107\n```\n:::\n:::\n\n\n\\$\\widehat{body-mass} = -5872 + 50.2\\*flipper-length \\$\n\n## How was this model fit?\n\nSee the code below. Note: this code is beyond the scope of this course, although I bet we know most of it already!\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins <- na.omit(penguins)\n\nfit <- lm(body_mass_g ~ flipper_length_mm, data = penguins)\n\n\npenguins$predicted <- predict(fit)\npenguins$residuals <- residuals(fit)\n\npenguins |>\nggplot(aes(x = flipper_length_mm, y = body_mass_g)) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"lightgrey\") +\n  geom_segment(aes(xend = flipper_length_mm, yend = predicted), alpha = .2) +\n\n  # > Color AND size adjustments made here...\n  geom_point(aes(color = abs(residuals), size = abs(residuals))) + # size also mapped\n  scale_color_continuous(low = \"black\", high = \"red\") +\n  guides(color = \"none\", size = \"none\") +  # Size legend also removed\n  # <\n\n  geom_point(aes(y = predicted), shape = 1) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](ae-08-sa_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Model question\n\nPlease write the model equation below:\n\n\\$\\widehat{body-mass} = -5872 + 50.2\\*flipper-length \\$\n\n## Interpretation\n\n-   Interpret the slope and the intercept in the context of the data.\n\nHint: Think about what happens to y when we increase x by 1.\n\n**For a 1 mm increase in flipper length, we estimate on average a 50.2 g increase in body mass**\n\n**For a 1 mm increase in flipper length, we estimate a mean increase of 50.2 g in body mass**\n\n**For a penguin with 0 mm flipper length, we estimate on average a body mass of -5782g.**\n\nDoes the intercept make sense? Why or why not? In statistics, what does predicting outside the bounds of our data called?\n\n**Extrapolation**\n\n## Prediction\n\n-   What is the estimated mean body mass for a penguin with a flipper length of 210?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n-5872 + 50.2*210\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4670\n```\n:::\n:::\n\n\n-   What is the estimated mean body mass for a penguin with a flipper length of 100?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n-5872 + 50.2*100\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -852\n```\n:::\n:::\n\n\n## How can we make these predictions in R?\n\n1)  Fit your model in R below\n\n2)  Name it model1 and make sure to not use the `tidy()` argument when fitting your model\n\n3)  Next, we can use the `predict` function in R\n\nSteps 1 and 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ flipper_length_mm, data = penguins)\n```\n:::\n\n\nStep 3\n\nFill in the code below\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict(model1, data.frame(flipper_length_mm = 210))\n```\n:::\n\n\n## Correlation and r-squared\n\nBelow, calculate both the correlation coefficient and r-squared value between flipper length and body mass. Interpret each in the context of the problem.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins <- na.omit(penguins)\n\npenguins |>\n  select(flipper_length_mm, body_mass_g) |>\n  cor()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  flipper_length_mm body_mass_g\nflipper_length_mm         1.0000000   0.8729789\nbody_mass_g               0.8729789   1.0000000\n```\n:::\n\n```{.r .cell-code}\n #go to slack and post how to na.rm with Cor\n\n\nglance(model1)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7620922\n```\n:::\n:::\n\n\n## Next Question\n\n-   Now, we will investigate another question. A different researcher wants to look at body weight of penguins based on the island they were recorded on. What's different between this question and the last? Hint: Think about the variable type.\n\n**island is categorical**\n\n-   Make a dot plot, using geom_point, with species on the x-axis to investigate this relationship below. Additionally, calculate the mean body mass by island below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  ggplot(\n    aes(\n    x = island, y = body_mass_g\n  )) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](ae-08-sa_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n-   Now, fit the linear regression model and display the results. Write the estimated model output below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_reg() |>\n  set_engine(\"lm\") |>\n  fit(body_mass_g ~ island, data = penguins) |>\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  term            estimate std.error statistic   p.value\n  <chr>              <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)        4719.      49.4     95.4  2.22e-242\n2 islandDream       -1000.      75.4    -13.3  1.74e- 32\n3 islandTorgersen   -1011.     105.      -9.67 1.23e- 19\n```\n:::\n:::\n\n\nInterpretation ...\n\n**To Start Class on Tuesday!**\n",
    "supporting": [
      "ae-08-sa_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}