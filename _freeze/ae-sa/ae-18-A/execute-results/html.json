{
  "hash": "cbe6e5cefaf93aaffc026fb0ebe170be",
  "result": {
    "markdown": "---\ntitle: \"Suggested Answers: CLT\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(palmerpenguins)\n```\n:::\n\n\n## Central Limit Theorem\n\nTo start this activity, we are going to demonstrate what the CLT is all about.\n\nBelow, we are going to generate a *population distribution*. This is not observed in real life. We are simply pretending we know this for demonstration purposes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrs_pop <- tibble(x = rbeta(100000, 1, 5) * 100)\n\n\nrs_pop |>\n  ggplot(\n    aes(x = x)) +\n  geom_density(fill = \"blue\") \n```\n\n::: {.cell-output-display}\n![](ae-18-A_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nWe are now going to draw samples from this population distribution, take the mean and repeat this process!\n\nBelow, draw one sample.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(2)\n\nsamp_2 <- rs_pop |>\n  sample_n(size = 50) |>\n  summarize(x_bar = mean(x))\n\nsamp_2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  x_bar\n  <dbl>\n1  18.9\n```\n:::\n:::\n\n\nTo make a distribution of sample means.... we need to do this process over and over and over again. Let's do this below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(333) \n\nsampling <- rs_pop |>\n  rep_sample_n(size = 50, reps = 5000) |>\n  group_by(replicate) |>\n  summarize(xbar = mean(x))\n```\n:::\n\n\nNow, create a histogram of the sample means below. But, before you do.... please answer the following question:\n\n-- Do you expect this distribution to be normally distributed or not? Justify your answer?\n\n**Yes! We meet the sample size requirement. n greater than 30**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsampling |> \n  ggplot(\n    aes(x = xbar)\n  ) + \n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](ae-18-A_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nWe know that the mean of our sampling distribution should be about the same as the mean of our population distribution. Check this below:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsampling |>\n  summarize(m = mean(xbar))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n      m\n  <dbl>\n1  16.6\n```\n:::\n\n```{.r .cell-code}\nrs_pop |>\n  summarize(m = mean(x))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n      m\n  <dbl>\n1  16.6\n```\n:::\n:::\n\n\n**Takeaway** And we can use this to create confidence intervals for our population parameter of interest (much like we can with bootstrap methods)\n\n## Small Sample Size\n\nNow, let's change our sample size to 3, violating as assumption of the CLT, and see how it impacts our sampling distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(333) \n\nsampling <- rs_pop |>\n  rep_sample_n(size = 3, reps = 5000) |>\n  group_by(replicate) |>\n  summarize(xbar = mean(x))\n```\n:::\n\n\nAgain, create a histogram of the sample means and comment on the shape of the distribution below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsampling |>\n  ggplot(\n    aes(x = xbar)\n  ) + \n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](ae-18-A_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n**The histogram is skewed right**\n\n## Central Limit Theorem vs Bootstrapping\n\nNow, we will use each method to calculate 95% confidence intervals for true mean flipper length of penguins using each method.\n\n### Bootstrap Confidence Interval\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins2 <- penguins |>\n  filter(species !=\"Gentoo\")\n\nboot_df <- penguins2 |>\n  specify(response = flipper_length_mm , explanatory = species) |>\n  generate(reps = 20000, type = \"bootstrap\") |>\n  calculate(stat = \"diff in means\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nDropping unused factor levels Gentoo from the supplied explanatory variable 'species'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 1 rows containing missing values.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The statistic is based on a difference or ratio; by default, for\ndifference-based statistics, the explanatory variable is subtracted in the\norder \"Adelie\" - \"Chinstrap\", or divided in the order \"Adelie\" / \"Chinstrap\"\nfor ratio-based statistics. To specify this order yourself, supply `order =\nc(\"Adelie\", \"Chinstrap\")` to the calculate() function.\n```\n:::\n:::\n\n\nNow, let's use `boot_df`to create our 95% confidence interval.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboot_df |> \n  summarize(lower = quantile(stat , 0.025),\n            upper = quantile(stat , 0.975))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n  lower upper\n  <dbl> <dbl>\n1 -7.86 -3.87\n```\n:::\n:::\n\n\nInterpret your 95% confidence interval in the context of the problem below:\n\nWe are 95% confident that the true mean flipper length for penguins is between 199 and 202 mm.\n\n### CLT\n\nAre we justified to use CLT to create a 95% confidence interval? Why or why not?\n\nIndependence - We will assume this is a random sample of all penguins\n\nSample Size - 344 greater than 30\n\nFill in the following code to calculate a 95% CI using the CLT\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |> \n  summarize(m = mean(flipper_length_mm , na.rm = T))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n      m\n  <dbl>\n1  201.\n```\n:::\n\n```{.r .cell-code}\nest_mu <- 201\nest_sigma <- sd(penguins$flipper_length_mm , na.rm = T) / sqrt(344)\n\nqnorm(c(0.025, 0.975), est_mu, est_sigma)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 199.514 202.486\n```\n:::\n:::\n\n\nIs the CI from CLT the same or different than the one using bootstrap methods?\n\n**The Same**\n\n# BUT\n\nThese were only roughly the same because of a large sample size. With a small sample size, we need to use a distribution different from *Normal*. See AE-19!\n",
    "supporting": [
      "ae-18-A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}