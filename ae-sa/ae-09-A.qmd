---
title: "AE-09 Introduction to Probability: Suggested Answers"
categories: 
  - Application exercise
editor: visual
---

```{r}
library(tidyverse)
library(palmerpenguins)
library(knitr)
```

In today's activity, we will be working with sleep data. Specifically, we will look at the relationship between Myopia, and sleeping conditions. Nearsightedness (myopia) is a common vision condition in which near objects appear clear, but objects farther away look blurry.

```{r}

sleep_data <- tibble( 
  Slept_With = c("Darkness" , "Nightlight", "Full Light", "Total"),
  No_Myopia = c(155,153,34,342),
  Myopia = c(15,72,36,123),
  High_Myopia = c(2,7,5,14),
  Total = c(172,232,75,479))
  

```

## Question 1

-- Give two examples of an event from the data set `sleep_data`.

A = Sleep with darkness

B = Have myopia

## Question 2

-- What is the sample space for how an infant slept?

{Darkness, Nightlight, Full Light}

## Question 3

Let's define our event as follows: A = child slept with a nightlight as an infant ("Nightlight")

-- What is the probability that an infant slept with a nightlight?

232/479

-- What is the probability of $A^c$?

(172+75)/479

# Return of the Penguins

They are back! Please run the following code below to re-familiarize ourselves with these data. Data were collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.

```{r}
#| label: cata

data(penguins)

glimpse(penguins)
```

## Question 4

Now let's make at table looking at the relationship between species and island. Below, comment on what this code is doing.

```{r}
#| label: count

penguins |>
  count(species, island)
```

Gives us species by island information

To make the contingency table, we will use the function in dplry called pivot_wider(). It will take the data frame produced by count() that is current in a "long" format and reshape it to be in a "wide" format. We will also use the kable() function in the knitr package to neatly format our new table.

Use `pivot_wider` to create a contingency table. Hint: Use `?pivot_wider` to find information on the argument `values_fill`. When creating the contingency table, include 0s in there are any missing values.

```{r}
#| label: cont-demo

penguins |>
  count(species, island) |>
  pivot_wider(
    names_from = species,
    values_from = n,
    values_fill = 0
  )

```

## Question 5

For each of the following exercises:

Calculate the probability using the contingency table above.

Then write code to check your answer using the penguins data frame and dplyr functions.

Hint: Think about creating a new `prob` column that contains the calculation.

-- What is the probability that a random penguin is from the Biscoe island?

**Together**

```{r}
#| label: biscoe-prob

penguins |>
  count(island) |>
  mutate(prob = n / nrow(penguins)) |>
  filter(island == "Biscoe")
```

**Together**

-- What is the probability that a random penguin is not from the Biscoe island?

Let's introduce `pull()`. The function pull selects a column in a data frame and transforms it into a vector. This is useful to use it in combination with pipe operators and dplyr's verbs.

```{r}
#| label: biscoe-not-prob

penguins |>
  count(island) |>
  filter(island != "Biscoe") |>
  pull(n) |>
  sum() / nrow(penguins)

```

These probabilities can be calculated in more than one way. Let's do it again.

```{r}
#| label: biscoe-not-prob-2

penguins |>
  count(island) |>
  filter(island != "Biscoe") |>
  select(n) |>
  colSums() / nrow(penguins)


```

-- What is the probability that a random penguin is of the Chinstrap species?

```{r}
#| label: chinstrap-prob

penguins |>
  count(species) |>
  mutate(prob = n / nrow(penguins)) |>
  filter(species == "Chinstrap")
  
```

-- What is the probability that a random penguin is not of the Chinstrap species?

```{r}
#| label: chinstrap-not-prob

penguins |>
  count(species) |>
  filter(species != "Chinstrap") |>
  pull(n) |>
  sum() / nrow(penguins)

```

## Extension Questions

-- What is the probability that a random penguin is on the Biscoe island **and** is of the Adelie species?

-- What is the probability that a random penguin is on the Biscoe island **or** is of the Adelie species?

How are these questions different from above?

These questions consider more than one event

First, define your events below:

A - penguin is on Biscoe island

B - penguin is of the Adelie species

Write out these questions in **proper notation**.

P(A and B) 

P(A or B)

Perform the calculations in your console by typing the values out.

Next, confirm your calculations in R by writing code.

Remind yourself of your contingency table here:

```{r}
#| label: cont-table
penguins |>
  count(species, island) |>
  pivot_wider(names_from = species,
              values_from = n,
              values_fill = 0) |>
  kable()

```

## Stopped Here 

## More definitions

Population: the entire group you want to learn about. Often, it's useful to think the population is "truth"

Sample: Your sample of the population from which you draw inference.
