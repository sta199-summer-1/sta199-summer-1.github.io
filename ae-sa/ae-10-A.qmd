---
title: "AE-10 Probability II: Suggested Answers"
categories: 
  - Application exercise
editor: visual
---

```{r}
library(tidyverse)
library(palmerpenguins)
library(knitr)
```

# Return of the Penguins

They are back! Please run the following code below to re-familiarize ourselves with these data. Data were collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.

```{r}
#| label: data

data(penguins)

glimpse(penguins)
```

Remind yourself of your contingency table here:

```{r}
#| label: cont-table
penguins |>
  count(species, island) |>
  pivot_wider(names_from = species,
              values_from = n,
              values_fill = 0) |>
  kable()

```

## Sample Space

How large is the sample space of any penguin? Can we check this in R?

```{r}
#| label: sample-space

penguins |>
  count(island, species) |> 
  nrow()

```

## And / Or probabilities

First, define your events below:

A - penguin is on Biscoe island

B - penguin is of the Adelie species

These are also called **joint** probabilities. Please answer the following questions below.

-- What is the probability that a random penguin is on the Biscoe island **and** is of the Adelie species?

-- What is the probability that a random penguin is on the Biscoe island **or** is of the Adelie species?

**Steps**

Perform the calculations in your console by typing the values out.

Next, confirm your calculations in R by writing code.

Hint: When calculating `and` or `or` probabilities... I suggest following these steps:

-   Create an indicator variable to match the events of your probability calculation

-   Take the mean of that variable

```{r}
#| label: and

penguins |>
  mutate(ind = (species == "Adelie" & island == "Biscoe")) |>
  summarize(mean(ind))

```

```{r}
#| label: or

penguins |>
  mutate(ind = (species == "Adelie" | island == "Biscoe")) |>
  summarize(mean(ind))

```

## Conditional Probabilities

**Conditional probability**: The probability an event occurs given the other has occurred

-- What is the probability that a random penguin is on the Biscoe island **given** the penguin of the Adelie species?

Hint: Create an appropriate table with `count` and `filter`. Next, create a new column that has the appropriate probability calculations. calculate the correct denominator using `sum`. `colSums` will produce an error within the function mutate. A more detailed explanation of this can be found in Slack.

```{r}

penguins |>
  count(species, island) |>
  filter(species == "Adelie") |>
  mutate(prob = n / sum(n))

```

## Independence?

Are living on the Biscoe island and being an Adelie species independent events? Justify your answer?

No: The probability of being on the Biscoe island, given the penguin is of the Adlie speices is not equal to just the probability of being on the Biscoe island. 

## Computer Store

To assess our understanding of probability, we will practice filling in a table based on a couple given values.

In a computer store, 30% of the computers in stock are laptops and 70% are desktops. Five percent of the laptops are on sale, while 10% of the desktops are on sale. Assume that the table total is 1000.

A - A computer is on sale

B - Is a desktop

```{r}
#| label: table-create
#| eval: false


data <- tibble( 
  Type = c("Desktop", "Desktop" , "Laptop" , "Laptop"),
  Sale = c("Sale", "No-Sale" , "Sale", "No-Sale"),
  values = c(70,630,15,285) #change code here
  )

data |>
  pivot_wider( 
    names_from = Type,
    values_from = values)
```

# Extension Question (Only if time)

Bike sharing systems are new generation of traditional bike rentals where whole process from membership, rental and return back has become automatic. You are tasked to investigate the relationship between the temperature outside and the number of bikes rented in the Washington DC area between the years 2011 and 2022. You will be investigating data for the months June, July, September, and November.

## Simpson's Paradox

```{r}
#| label: bike-data
bike <- read_csv("data/bike.csv")
```

-- Create a scatter plot that investigates the relationship between the number of bikes rented and the temperature outside. Include a straight line of best fit to help discuss the discovered relationship. Summarize your findings.

```{r}
#| label: plot-1

bike |> 
  ggplot(
    aes(y = cnt , x = temp)
  ) + 
  geom_point() + 
  geom_smooth(method = "lm" , se = FALSE)

```

This scatter plot would suggest a positive relationship between count and temperature. 

-- Another researcher suggests to look at the relationship between bikes rented and temperature by each of the four months of interest. Recreate your plot in part a, and color the points by month. Include a straight line for each of the four months to help discuss each month's relationship between bikes rented and temperature. In 3-4 sentences, summarize your findings.

```{r}
#| label: plot-2

bike |> 
  mutate(mnth = as.factor(mnth)) |> 
  ggplot(
    aes(y = cnt, x = temp, color = mnth)
  ) + 
  geom_point() +
  geom_smooth(method = "lm" , se = FALSE)
```

Now that our data are grouped by month, we see four varying negative trends between count and temperature by month. This is vastly different of a story vs the ungrouped data. 

For more information on Simpson's Paradox, please watch the following video on Simpson's Paradox [here](https://www.youtube.com/watch?v=ebEkn-BiW5k).
